{% load static %}

<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ویلاها</title>

  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.rtl.min.css" integrity="sha384-gXt9imSW0VcJVHezoNQsP+TNrjYXoGcrqBZJpry9zJt8PCQjobwmhMGaDHTASo9N" crossorigin="anonymous">
  <link rel="stylesheet" href="{% static 'Date/Css_Style/insertbox_css.css' %}" type="text/css">

</head>

<body style="font-size: 20px;">

  <div class="container">
    <div class="row mb-5 mt-1">
      <div class="col-md-12 bg-danger w-100">
  
      </div>
    </div>
  </div>
  
  <div class="container shadow-lg p-3" style="border-radius: 20px;">
    <div class="row">
      <div class="col-md-12">
        <div class="row">
          <div class="col-md-12">
          <div class="row">

            <div class="col-md-6">

              <div id="carouselExampleSlidesOnly" class="carousel slide" data-ride="carousel">
                <div class="carousel-inner">
                  {% for picture in gallery_villa %}
                    <div class="carousel-item w-100 {{forloop.first|yesno:'active,'}}">
                      <img style="height: 400px; border-radius: 15px;"  class="d-block w-100"  src="{{picture.image.url}}" alt="First slide">
                    </div>
                  {% endfor %}
                </div>
              </div>

            </div>

            <div class="col-md-6" style="direction: rtl !important;">
              <h5><span>اسم صاحب ویلا</span> : <span>{{data_villa.name}}</span></h5>
              <p><span>شهر</span> : <span>{{data_villa.city_name.title_fa}}</span></p>
              <p><span>امکانات</span> : <span>
                <ul>
                  {% for i in data_villa.option.all %}
                    <span><li>{{i.title}}</li></span>
                  {% endfor %}
                </ul>
              </span></p>
              <p><span>اجاره</span> : <span>{{data_villa.price|floatformat:"g"}}</span><b class="ps-2">تومان</b></p>
              
              <div class="text-start align-content-start">
                <div class="mt-1 ">
                  {% if request.user.is_authenticated %}
                      

                      {% if data_villa.status %}
                        <button type="button" class="btn btn-primary w-25 " disabled >رزرو شده</button>
                      {% else %}
                        <input type="number" value="{{data_villa.id}}" id="villa_id" hidden>
                        <input type="number" min="1" class="w-25" placeholder="تعداد روز ماندن" id="count">
                        <div class="form-field w-50">
                          <label for="" class="text-bg-dark mb-3">تاریخ رزرو : </label>
                          <input type="text" name="date" id="pcal1" class="pdate m-1 mb-2">
                        </div>
                        <button onclick="Reservation({{request.user.id}})" style="border-radius: 7px; background-color: #e36414; font-size: 25px; font-weight: bold; height: 50px;" class="btn w-25 text-white p-0" >رزرو</button>

                      {% endif %}
                  {% endif %}
                </div>
              </div>
              
            </div>

          </div>
          </div>
        </div>
      </div>

      <div class="row pt-3 ps-0 pe-4 " style="direction: rtl !important; ">
        <div style="border-radius: 7px; background-color: #f78138;" class="col-md-12 ">

          <div class="text-start align-items-start pt-1">
            <p>اماکن توریستی نزدیک</p>
          </div>

          <div class="row">
            {% for place in data_villa.tourist_places.all %}
              <div class="col-md-2 mb-2" style="margin-left: -40px;">
                <a href="{% url 'Home_Model:Detail' pk=place.pk %}"><img style="border-radius: 50%;" class="card-img-top w-50" src="{{place.image.url}}" alt="Card image cap"></a>
              </div>
            {% endfor %}
          </div>
          
        </div>
      </div>
    </div>
  </div>

  <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
  <!-- <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script> -->
  <script src="https://cdn.jsdelivr.net/npm/popper.js@1.12.9/dist/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>
  <script type="text/javascript" src="{% static 'Date/js/js-persian-cal.min.js' %}"></script>
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>


  <script type="text/javascript">
		var objCal1 = new AMIB.persianCalendar( 'pcal1' );


    function Reservation(userId){
            const VillaId = $('#villa_id').val()
            const Count = $('#count').val()
            const Date = $('#pcal1').val()
            // alert(Date)
            $.get('/reservation/villa?user_id=' + userId + '&count=' + Count + '&villa_id=' + VillaId + '&date=' + Date).then(res => {
                Swal.fire({
                    title: res.title,
                    text: res.text,
                    icon: res.icon,
                    showCancelButton: false,
                    confirmButtonColor: res.confirmButtonColor,
                    confirmButtonText: res.confirmButtonText
                }).then((result) => {
                    if (result.isConfirmed) {
                       if (res.status == 'not_auth'){
                        window.location.href = '/Account_Model/login'
                       }
                    }
                    })
                })
            }
	</script>
</body>
</html>